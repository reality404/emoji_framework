<html>
<head>
  <meta charset="utf-8">
<style>
  body{
    margin: 0 auto;
    overflow: hidden;
    /*background-color: black;*/
  }

  #container {
    width: 100%;
    height: 100%;
    position: relative;
}
</style>
</head>
<body>

<div id="container"></div>

<script>

  const container = document.getElementById("container");

  const canvas = document.createElement('canvas');  
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  canvas.classList.add("canvas");
  canvas.style.position = "absolute"; 
  canvas.style.zIndex = "+2"; 
  container.appendChild(canvas);           
  const ctx = canvas.getContext('2d');

  const canvasO = document.createElement('canvas');
  canvasO.width = "130";
  canvasO.height = "130";
  const ctxO = canvasO.getContext('2d');

  //work out the border of the emoji
  let bound = {     
      top: null,
      left: null,
      right: null,
      bottom: null
    },boundX,boundY;

  let imgData;
  let fontSize = "100";
  let emojiArray = [];

  //lets put a function on that face 
   function emojiFunc ({emoji}){

    //console.log(emojiList[i]);

    ctxO.clearRect(0, 0, canvasO.width, canvasO.height);
    imgData = [];
    bound = {     
      top: null,
      left: null,
      right: null,
      bottom: null
    };
    
    ctxO.textBaseline = "top"; 
    //ctxO.textBaseline = "middle"; 
    ctxO.textAlign = "center";
    ctxO.font = fontSize+"px serif"; //a font type is needed even though we are using emojis
    ctxO.fillText(emoji, 15+(fontSize/2), 15);

    imgData = ctxO.getImageData(0, 0, 130, 130);
    let imgBase64 = canvasO.toDataURL();

    for (let j = 0; j < imgData.data.length; j += 4) {
      if (imgData.data[j+3] !== 0) {
            
          boundX = (j / 4) % canvasO.width;
          boundY = ~~((j / 4) / canvasO.width);
  
          if (bound.top === null) {
            bound.top = boundY;
          }
      
          if (bound.left === null) {
            bound.left = boundX; 
          } else if (boundX < bound.left) {
            bound.left = boundX;
          }
      
          if (bound.right === null) {
            bound.right = boundX; 
          } else if (bound.right < boundX) {
            bound.right = boundX;
          }
      
          if (bound.bottom === null) {
            bound.bottom = boundY;
          } else if (bound.bottom < boundY) {
            bound.bottom = boundY;
          }
        }
      }

      let trimHeight = bound.bottom - bound.top + 1,
      trimWidth = bound.right - bound.left + 1;

    let emojiInfo = {emoji:emoji,emoji64:imgBase64,sx:bound.left,sy:bound.top,sWidth:trimWidth,sHeight:trimHeight};
    emojiArray.push(emojiInfo);

  }
  
  let emojiList = ["â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ¤","ğŸ–¤","ğŸ¤","ğŸ’—","ğŸ±","ğŸ˜¼","ğŸ˜¹","ğŸ™€","ğŸ˜¾","ğŸ˜¿","ğŸ˜»","ğŸ˜º","ğŸ˜¸","ğŸ˜½","ğŸ”¥","ğŸ“","ğŸ‘€","ğŸ‘ï¸â€ğŸ—¨ï¸","ğŸŒœ","ğŸ","ğŸ”©","âœï¸","ğŸ’©"];
  for (let i = 0; i < emojiList.length; i++) {
    emojiFunc({emoji:emojiList[i]});
  }
  console.log(emojiArray);


  function emojiGet(emoji,get){
    let output = emojiArray.find(obj => obj.emoji == emoji)[get];
    return(output);
  }

  console.log(emojiGet("ğŸ’œ","sx"))



  function emojiSize(emoji,size){

    let sWidth = emojiArray.find(obj => obj.emoji == emoji).sWidth;
    let sHeight = emojiArray.find(obj => obj.emoji == emoji).sHeight;

    let dWidth = sWidth - (sWidth - size);
    let dHeight = sHeight - (sWidth - size);

    return[dWidth,dHeight];

  }

  //let [dWidth, dHeight] = emojiSizeFunc({emoji:"ğŸ’™",size:10});
  //console.log(dWidth);


  var images = [emojiGet("ğŸ’›","emoji64"),emojiGet("ğŸ¤","emoji64"),emojiGet("ğŸ’œ","emoji64"),emojiGet("ğŸ–¤","emoji64")];
  var promiseArray = images.map(function(imgurl){
   var prom = new Promise(function(resolve,reject){
       var img = new Image();
       img.onload = function(){
           resolve(img);
       };
       img.src = imgurl;
   });
   return prom;
});


let x = 1;
let x1 = 1;
let x2 = 1;
let x3 = 1;
let x4 = 1;
let x5 = 1;
let state = true ;
let state1 = true ;
let state2 = true ;
let state3 = true ;
let state4 = true ;
let state5 = true ;

Promise.all(promiseArray).then(images => { // new fuction if all images are loaded with the image data
  console.log("img: ",images[0])

  function drawIt() { 
    window.requestAnimationFrame(drawIt);  

    ctx.clearRect(0,0,canvas.width,canvas.height)
    
    if (x < 500 && state === true){
      x +=1;
      console.log(x)
    } 

    if (x > 500 || x === 500){
      state = false;
      console.log(x)
    } 

    if (state === false && x > 0){
      x -=1;
    }

    if (x === 0) {
    state = true;
    }

    if (x1 < 400 && state1 === true){
      x1 +=1;
    } 
    if (x1 > 400 || x1 === 400){
      state1 = false;
    } 
    if (state1 === false && x1 > 0){
      x1 -=1;
    }
    if (x1 === 0) {
    state1 = true;
    }

    if (x2 < 300 && state2 === true){
      x2 +=1;
    } 
    if (x2 > 300 || x2 === 300){
      state2 = false;
    } 
    if (state2 === false && x2 > 0){
      x2 -=1;
    }
    if (x2 === 0) {
    state2 = true;
    }

    if (x3 < 200 && state3 === true){
      x3 +=1;
    } 
    if (x3 > 200 || x3 === 200){
      state3 = false;
    } 
    if (state3 === false && x3 > 0){
      x3 -=1;
    }
    if (x3 === 0) {
    state3 = true;
    }
  
    ctx.drawImage(images[0],emojiGet("ğŸ’›","sx"),emojiGet("ğŸ’œ","sy"),emojiGet("ğŸ’œ","sWidth"),emojiGet("ğŸ’œ","sHeight"),300-(x/2),300-(x/2),(emojiSize("ğŸ’œ",10)[0])+x,(emojiSize("ğŸ’œ",10)[1])+x);
    ctx.drawImage(images[1],emojiGet("ğŸ¤","sx"),emojiGet("ğŸ’œ","sy"),emojiGet("ğŸ’œ","sWidth"),emojiGet("ğŸ’œ","sHeight"),300-(x1/2),300-(x1/2),(emojiSize("ğŸ’œ",10)[0])+x1,(emojiSize("ğŸ’œ",10)[1])+x1);
    ctx.drawImage(images[2],emojiGet("ğŸ¤","sx"),emojiGet("ğŸ’œ","sy"),emojiGet("ğŸ’œ","sWidth"),emojiGet("ğŸ’œ","sHeight"),300-(x2/2),300-(x2/2),(emojiSize("ğŸ’œ",10)[0])+x2,(emojiSize("ğŸ’œ",10)[1])+x2);
    ctx.drawImage(images[3],emojiGet("ğŸ¤","sx"),emojiGet("ğŸ’œ","sy"),emojiGet("ğŸ’œ","sWidth"),emojiGet("ğŸ’œ","sHeight"),300-(x3/2),300-(x3/2),(emojiSize("ğŸ’œ",10)[0])+x3,(emojiSize("ğŸ’œ",10)[1])+x3);
    
    //ctx.drawImage(images[1],emojiGet("ğŸ’œ","sx"),emojiGet("ğŸ’œ","sy"),emojiGet("ğŸ’œ","sWidth"),emojiGet("ğŸ’œ","sHeight"),100,x,emojiSize("ğŸ’œ",100)[0],emojiSize("ğŸ’œ",100)[1]);
    //context.drawImage(image, sx ,sy,sWidth,sHeight,dx,dy,dWidth,dHeight);

    //ctx.drawImage(images[0],114 ,x )

  }
drawIt();

}); // end the promise!

</script>
</body>
</html>